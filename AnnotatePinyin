javascript:(async()=>{if(!window.pinyinPro){await new Promise((r,j)=>{const s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/pinyin-pro@3.27.0/dist/index.min.js";s.onload=r;s.onerror=j;document.head.appendChild(s);});}const style=document.createElement("style");style.textContent="ruby{ruby-position:under;font-size:1.1em;}rt{font-size:.6em;color:#d33;}";document.head.appendChild(style);const hanzi=/[\u4e00-\u9fff]/;function annotate(n){if(!hanzi.test(n.nodeValue))return;const f=document.createDocumentFragment();for(const c of n.nodeValue){if(hanzi.test(c)){const py=window.pinyinPro.pinyin(c,{toneType:'mark'});const ruby=document.createElement('ruby');ruby.textContent=c;const rt=document.createElement('rt');rt.textContent=py;ruby.appendChild(rt);f.appendChild(ruby);}else{f.appendChild(document.createTextNode(c));}}n.parentNode.replaceChild(f,n);}const w=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null,false);const nodes=[];while(w.nextNode())nodes.push(w.currentNode);for(const n of nodes)annotate(n);const banner=document.createElement('div');banner.textContent='âœ… Pinyin annotation done';banner.style.cssText='position:fixed;top:0;left:0;width:100%;background:lime;color:black;font-size:18px;text-align:center;padding:8px;z-index:999999';document.body.appendChild(banner);setTimeout(()=>banner.remove(),3000);})();
